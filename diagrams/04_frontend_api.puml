@startuml Frontend & API Layer

skinparam backgroundColor #261D45
skinparam defaultFontColor #96DDF2

skinparam component {
  BackgroundColor #100D23
  BorderColor #0BE784
  FontColor #96DDF2
  ArrowColor #01C176
}

skinparam database {
  BackgroundColor #100D23
  BorderColor #0BE784
  FontColor #96DDF2
}

skinparam package {
  BackgroundColor #231B3D
  BorderColor #3f2c70
  FontColor #96DDF2
}

skinparam actor {
  BackgroundColor #0BE784
  BorderColor #0BE784
  FontColor #100D23
}

skinparam note {
  BackgroundColor #231B3D
  BorderColor #3f2c70
  FontColor #96DDF2
}

title <color:#0BE784>Frontend & API Architecture</color>

actor User #0BE784

package "Frontend Components" #231B3D {
  component "Vue.js\nReactive UI" as Vue
  component "D3.js\nRadial Tree" as D3
  component "Bootstrap\nResponsive" as Bootstrap
}

package "API Endpoints" #231B3D {
  component "/api/pending-accounts/\n(5s auto-refresh)" as PendingAPI
  component "/api/stage-executions/\n(5s auto-refresh)" as StagesAPI
  component "/search/\n(Main search)" as SearchAPI
}

database "Astra DB" as DB

User -[#01C176]-> Vue : "Interacts"
User -[#01C176]-> D3 : "Views Tree"
Vue -[#01C176]-> PendingAPI : "Polls every 5s"
Vue -[#01C176]-> StagesAPI : "Polls every 5s"
User -[#01C176]-> SearchAPI : "Searches"
PendingAPI -[#01C176]-> DB : "2 queries with IN"
StagesAPI -[#01C176]-> DB : "Stage status"
SearchAPI -[#01C176]-> DB : "Initiate pipeline"

note right of PendingAPI #231B3D
  <color:#0BE784>Optimized Query:</color>
  <color:#96DDF2>FROM stellar_account_search_cache
  WHERE status IN (
    'PENDING',
    'IN_PROGRESS',
    'RE_INQUIRY'
  )
  
  FROM stellar_creator_account_lineage
  WHERE status IN (...)</color>
  
  <color:#01C176>Result: 88% fewer queries</color>
end note

note right of StagesAPI #231B3D
  <color:#0BE784>Features:</color>
  <color:#96DDF2>• Real-time progress
  • Interactive JSON viewer
  • Immediate initialization
  • 8 stages per address</color>
end note

@enduml
