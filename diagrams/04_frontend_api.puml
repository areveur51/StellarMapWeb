@startuml 04_frontend_api

skinparam backgroundColor #261D45
skinparam defaultFontColor #96DDF2

top to bottom direction

skinparam component {
  BackgroundColor #100D23
  BorderColor #0BE784
  FontColor #96DDF2
  ArrowColor #01C176
}

skinparam database {
  BackgroundColor #100D23
  BorderColor #0BE784
  FontColor #96DDF2
}

skinparam actor {
  BackgroundColor #0BE784
  BorderColor #0BE784
  FontColor #100D23
}

skinparam note {
  BackgroundColor #231B3D
  BorderColor #3f2c70
  FontColor #96DDF2
}

title <color:#0BE784>Frontend & API Architecture

actor User #0BE784

component "Vue.js Reactive UI" as Vue
component "D3.js Tree Visualization" as D3
component "Query Builder UI" as QueryBuilder

component "/api/pending-accounts/" as PendingAPI
component "/api/account-lineage/" as LineageAPI
component "/web/query-builder/" as QueryBuilderAPI
component "/search/" as SearchAPI
component "/web/high-value-accounts/" as HVAAPI

database "Astra DB (Cassandra)" as DB

User -down-> Vue
User -down-> D3
User -down-> QueryBuilder
User -down-> SearchAPI
User -down-> HVAAPI

Vue -down-> PendingAPI : "polls 30s"
D3 -down-> LineageAPI
QueryBuilder -down-> QueryBuilderAPI

PendingAPI -down-> DB
LineageAPI -down-> DB
QueryBuilderAPI -down-> DB
SearchAPI -down-> DB
HVAAPI -down-> DB

note right of PendingAPI
  <color:#0BE784>Pending Accounts API
  <color:#96DDF2>• 30s TTL cache
  <color:#96DDF2>• Status IN clause
  <color:#01C176>• 88% fewer queries
end note

note right of SearchAPI
  <color:#0BE784>Main Search API
  <color:#96DDF2>1. Validate address
  <color:#96DDF2>2. Queue as PENDING
  <color:#0BE784>3. BigQuery processes
  <color:#96DDF2>4. Returns in 50-90s
  <color:#96DDF2>• Up to 100K children
end note

note right of HVAAPI
  <color:#0BE784>HVA Leaderboard
  <color:#96DDF2>• Multi-threshold
  <color:#96DDF2>• 10K-1M XLM
  <color:#96DDF2>• Smart queries
  <color:#0BE784>• 24h rank changes
end note

note right of QueryBuilderAPI
  <color:#0BE784>Query Builder
  <color:#96DDF2>• 10 pre-defined queries
  <color:#96DDF2>• Custom AND logic
  <color:#96DDF2>• Adaptive max_scan
  <color:#96DDF2>• 50-500 result limit
end note

@enduml
