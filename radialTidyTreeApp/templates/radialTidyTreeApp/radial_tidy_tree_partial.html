<!-- radialTidyTreeApp/templates/radialTidyTreeApp/radial_tidy_tree_partial.html -->
{% load static %}

<div id="radial-tree-container">
    <svg id="tree" width="800" height="800"></svg>
    
    <script>
        // Use the tree data from the parent Vue component via json_script
        // The tree-data-json element is created in the parent template
        const renderTreeWhenReady = () => {
            const treeDataEl = document.getElementById('tree-data-json');
            if (treeDataEl && typeof renderRadialTree === 'function') {
                const treeData = JSON.parse(treeDataEl.textContent);
                console.log('Processing tree data:', treeData);
                console.log('Tree has', treeData.children ? treeData.children.length : 0, 'children');
                renderRadialTree(treeData);
                console.log('Radial tree rendered successfully');
            } else {
                // Retry after a short delay if not ready yet
                setTimeout(renderTreeWhenReady, 100);
            }
        };
        
        // Wait for DOM to be ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', renderTreeWhenReady);
        } else {
            // DOM is already loaded
            renderTreeWhenReady();
        }
    </script>
</div>
